import { createContext, useContext } from 'react';

export type LanguageCode = 'fr' | 'en';

export const TRANSLATIONS = {
  fr: {
    appName: 'Homybudget',
    settingsLabel: 'Settings',
    backLabel: 'Retour',
    logoutLabel: 'Deconnexion',
    budgetLabel: 'Budget',
    dashboardLabel: 'Dashboard',
    reportsLabel: 'Rapport',
    addNextMonth: 'Ajouter le mois suivant',
    deleteMonth: 'Supprimer ce mois',
    deleteMonthConfirm: 'Cette action est irreversible.',
    deleteMonthError: 'La suppression a echoue. Verifie la connexion au serveur.',
    monthSelectLabel: 'Selection du mois',
    tableLabel: 'Tableau',
    person1Label: 'Personne 1',
    person2Label: 'Personne 2',
    incomeLabel: 'Revenus',
    incomePlaceholder: 'Source de revenu',
    totalIncomeLabel: 'Total Revenus',
    totalExpensesLabel: 'Total des Depenses',
    availableLabel: 'Disponible',
    fixedMoneyLabel: 'Argent Fixe',
    freeMoneyLabel: 'Argent Libre',
    addLabel: 'Ajouter',
    totalExpensesShortLabel: 'Depenses totales',
    validateExpenseLabel: 'Valider la depense',
    editLabel: 'Editer',
    closeEditLabel: 'Fermer',
    deleteLabel: 'Supprimer',
    moveUpLabel: 'Monter la ligne',
    moveDownLabel: 'Descendre la ligne',
    addRowLabel: 'Ajouter une ligne',
    installmentLabel: 'Paiement echelonne',
    startLabel: 'Debut',
    jointAccountTitle: 'Compte Joint - Epargne Commune',
    depositLabel: 'Versement',
    expenseLabel: 'Depense',
    initialBalanceLabel: 'Solde initial',
    currentBalanceLabel: 'Solde actuel',
    dateLabel: 'Date',
    typeLabel: 'Type',
    descriptionLabel: 'Description',
    amountLabel: 'Montant',
    personLabel: 'Personne',
    depositOptionLabel: '+ Versement',
    expenseOptionLabel: '- Depense',
    noOtherPaletteLabel: 'Aucune autre palette',
    accountMenuLabel: 'Menu du compte',
    loginTitle: 'Connexion',
    loginUsernameLabel: 'Identifiant',
    loginPasswordLabel: 'Mot de passe',
    loginButton: 'Se connecter',
    loginLoading: 'Connexion...',
    onboardingTitle: 'Premiere installation',
    onboardingStepLabel: 'Etape',
    onboardingAdminUsernameLabel: 'Identifiant admin',
    onboardingAdminPasswordLabel: 'Mot de passe admin',
    onboardingAdminConfirmLabel: 'Confirmer',
    onboardingCreateAdmin: 'Creer admin',
    onboardingCreatingAdmin: 'Creation...',
    onboardingBootstrapError: "Impossible de creer l'admin.",
    onboardingLanguageTitle: 'Choisir la langue',
    onboardingThemeTitle: 'Mode clair ou sombre',
    onboardingModeTitle: 'Mode solo ou duo',
    onboardingSoloLabel: 'Solo',
    onboardingDuoLabel: 'Duo',
    onboardingNamesTitle: 'Noms des personnes',
    onboardingPerson1Placeholder: 'Personne 1',
    onboardingPerson2Placeholder: 'Personne 2',
    onboardingNext: 'Suivant',
    onboardingBack: 'Retour',
    onboardingFinish: 'Terminer',
    profileTitle: 'Profil',
    profileMenuLabel: 'Profil utilisateur',
    userLabel: 'Utilisateur',
    roleLabel: 'Role',
    profileImageLabel: 'Image de profil',
    profileImageHint: "Colle l'URL d'une image (PNG/JPG).",
    profileImageUrlPlaceholder: 'https://exemple.com/avatar.png',
    profileImageSaveButton: 'Mettre a jour',
    profileImageSaving: 'Mise a jour...',
    profileImageUpdated: 'Image mise a jour.',
    profileImageError: "Impossible de mettre a jour l'image.",
    profileImageUploadButton: 'Uploader',
    profileImageUploadLoading: 'Upload...',
    profileImageUploadSuccess: 'Image envoyee.',
    profileImageUploadError: "Impossible d'envoyer l'image.",
    settingsSectionTitle: 'Parametres',
    sortExpensesLabel: 'Tri des depenses par cout',
    fixedFreeLabel: 'Argent Fixe et Argent Libre',
    jointAccountSettingLabel: 'Compte joint',
    jointAccountSettingHint: 'Afficher ou masquer le compte joint',
    soloModeSettingLabel: 'Mode solo',
    soloModeSettingHint: 'Masquer la seconde personne',
    personLinkSectionTitle: 'Association des personnes',
    personLinkSectionHint: 'Choisis quel utilisateur correspond a chaque personne.',
    unassignedLabel: 'Aucun',
    activeLabel: 'Actif',
    inactiveLabel: 'Inactif',
    defaultModeLabel: 'Mode par defaut',
    currencyLabel: 'Devise',
    currencyEuroLabel: 'Euro (EUR)',
    currencyDollarLabel: 'Dollar (USD)',
    themeToggleLabel: 'Mode clair/sombre',
    lightLabel: 'Clair',
    darkLabel: 'Sombre',
    languageLabel: 'Langue',
    frenchLabel: 'Francais',
    englishLabel: 'English',
    moreSettingsSoon: 'Autres parametres bientot disponibles.',
    comingSoonLabel: 'Bientot disponible.',
    updateAvailableLabel: 'maj dispo',
    changePasswordTitle: 'Changer le mot de passe',
    currentPasswordPlaceholder: 'Mot de passe actuel',
    newPasswordPlaceholder: 'Nouveau mot de passe',
    confirmPasswordPlaceholder: 'Confirmer',
    updateButton: 'Mettre a jour',
    updatingButton: 'Mise a jour...',
    userManagementTitle: 'Gestion des utilisateurs',
    refreshButton: 'Rafraichir',
    createUserButton: 'Creer un utilisateur',
    creatingUserButton: 'Creation...',
    resetTokenTitle: 'Token de reinitialisation',
    expiresOnLabel: 'Expire le',
    loadingUsers: 'Chargement des utilisateurs...',
    noUsers: 'Aucun utilisateur trouve.',
    accountLabel: 'Compte',
    statusLabel: 'Statut',
    lastLoginLabel: 'Derniere connexion',
    actionsLabel: 'Actions',
    blockedLabel: 'Bloque',
    resetButton: 'Reinitialiser',
    createUserUsernamePlaceholder: 'Identifiant',
    createUserDisplayNamePlaceholder: 'Nom affiche',
    createUserPasswordPlaceholder: 'Mot de passe',
    createUserConfirmPlaceholder: 'Confirmer',
    roleUserLabel: 'Utilisateur',
    roleAdminLabel: 'Admin',
    passwordRequiredError: 'Veuillez saisir votre mot de passe actuel et le nouveau.',
    passwordMismatchError: 'Les mots de passe ne correspondent pas.',
    passwordUpdatedSuccess: 'Mot de passe mis a jour.',
    passwordChangeError: 'Impossible de changer le mot de passe.',
    userLoadError: 'Impossible de charger les utilisateurs.',
    userCreateRequiredError: 'Identifiant et mot de passe requis.',
    userCreateMismatchError: 'Les mots de passe ne correspondent pas.',
    userCreateSuccess: 'Utilisateur cree.',
    userCreateError: "Impossible de creer l'utilisateur.",
    userRoleUpdateError: 'Impossible de mettre a jour le role.',
    userStatusUpdateError: 'Impossible de mettre a jour le statut.',
    resetTokenError: 'Impossible de creer le token de reset.',
    monthUnavailableError: 'Mois indisponible. Cree le mois ou choisis un mois existant.',
    sessionExpiredError: 'Session expiree. Merci de vous reconnecter.',
    authRequiredError: 'Identifiants requis.',
    authInvalidError: 'Identifiants invalides.',
    authServerError: 'Impossible de se connecter au serveur.',
    expenseWizardTitle: 'Ajouter une depense',
    expenseNameLabel: 'Nom',
    categoryLabel: 'Categorie',
    categoryAutoLabel: 'Auto',
    cancelLabel: 'Annuler',
    newIncomeSourceLabel: 'Nouvelle source',
    newFixedExpenseLabel: 'Nouvelle depense',
    newCategoryLabel: 'Nouvelle categorie',
    newDepositDescription: 'Nouveau versement',
    newExpenseDescription: 'Nouvelle depense'
  },
  en: {
    appName: 'Homybudget',
    settingsLabel: 'Settings',
    backLabel: 'Back',
    logoutLabel: 'Logout',
    budgetLabel: 'Budget',
    dashboardLabel: 'Dashboard',
    reportsLabel: 'Reports',
    addNextMonth: 'Add next month',
    deleteMonth: 'Delete this month',
    deleteMonthConfirm: 'This action is irreversible.',
    deleteMonthError: 'Delete failed. Check the server connection.',
    monthSelectLabel: 'Select month',
    tableLabel: 'Table',
    person1Label: 'Person 1',
    person2Label: 'Person 2',
    incomeLabel: 'Income',
    incomePlaceholder: 'Income source',
    totalIncomeLabel: 'Total Income',
    totalExpensesLabel: 'Total Expenses',
    availableLabel: 'Available',
    fixedMoneyLabel: 'Fixed Expenses',
    freeMoneyLabel: 'Free Money',
    addLabel: 'Add',
    totalExpensesShortLabel: 'Total expenses',
    validateExpenseLabel: 'Mark expense',
    editLabel: 'Edit',
    closeEditLabel: 'Close',
    deleteLabel: 'Delete',
    moveUpLabel: 'Move up',
    moveDownLabel: 'Move down',
    addRowLabel: 'Add row',
    installmentLabel: 'Installment',
    startLabel: 'Start',
    jointAccountTitle: 'Joint Account - Shared Savings',
    depositLabel: 'Deposit',
    expenseLabel: 'Expense',
    initialBalanceLabel: 'Starting balance',
    currentBalanceLabel: 'Current balance',
    dateLabel: 'Date',
    typeLabel: 'Type',
    descriptionLabel: 'Description',
    amountLabel: 'Amount',
    personLabel: 'Person',
    depositOptionLabel: '+ Deposit',
    expenseOptionLabel: '- Expense',
    noOtherPaletteLabel: 'No other palette',
    accountMenuLabel: 'Account menu',
    loginTitle: 'Sign in',
    loginUsernameLabel: 'Username',
    loginPasswordLabel: 'Password',
    loginButton: 'Sign in',
    loginLoading: 'Signing in...',
    onboardingTitle: 'First setup',
    onboardingStepLabel: 'Step',
    onboardingAdminUsernameLabel: 'Admin username',
    onboardingAdminPasswordLabel: 'Admin password',
    onboardingAdminConfirmLabel: 'Confirm',
    onboardingCreateAdmin: 'Create admin',
    onboardingCreatingAdmin: 'Creating...',
    onboardingBootstrapError: 'Unable to create admin.',
    onboardingLanguageTitle: 'Choose language',
    onboardingThemeTitle: 'Light or dark',
    onboardingModeTitle: 'Solo or duo',
    onboardingSoloLabel: 'Solo',
    onboardingDuoLabel: 'Duo',
    onboardingNamesTitle: 'People names',
    onboardingPerson1Placeholder: 'Person 1',
    onboardingPerson2Placeholder: 'Person 2',
    onboardingNext: 'Next',
    onboardingBack: 'Back',
    onboardingFinish: 'Finish',
    profileTitle: 'Profile',
    profileMenuLabel: 'User profile',
    userLabel: 'User',
    roleLabel: 'Role',
    profileImageLabel: 'Profile image',
    profileImageHint: 'Paste an image URL (PNG/JPG).',
    profileImageUrlPlaceholder: 'https://example.com/avatar.png',
    profileImageSaveButton: 'Update',
    profileImageSaving: 'Updating...',
    profileImageUpdated: 'Image updated.',
    profileImageError: 'Unable to update image.',
    profileImageUploadButton: 'Upload',
    profileImageUploadLoading: 'Uploading...',
    profileImageUploadSuccess: 'Image uploaded.',
    profileImageUploadError: 'Unable to upload image.',
    settingsSectionTitle: 'Preferences',
    sortExpensesLabel: 'Sort expenses by cost',
    fixedFreeLabel: 'Fixed & Free Money',
    jointAccountSettingLabel: 'Joint account',
    jointAccountSettingHint: 'Show or hide the joint account',
    soloModeSettingLabel: 'Solo mode',
    soloModeSettingHint: 'Hide the second person',
    personLinkSectionTitle: 'People mapping',
    personLinkSectionHint: 'Choose which user is Person 1 and Person 2.',
    unassignedLabel: 'None',
    activeLabel: 'Active',
    inactiveLabel: 'Inactive',
    defaultModeLabel: 'Default theme',
    currencyLabel: 'Currency',
    currencyEuroLabel: 'Euro (EUR)',
    currencyDollarLabel: 'Dollar (USD)',
    themeToggleLabel: 'Light/Dark mode',
    lightLabel: 'Light',
    darkLabel: 'Dark',
    languageLabel: 'Language',
    frenchLabel: 'French',
    englishLabel: 'English',
    moreSettingsSoon: 'More settings coming soon.',
    comingSoonLabel: 'Coming soon.',
    updateAvailableLabel: 'update available',
    changePasswordTitle: 'Change password',
    currentPasswordPlaceholder: 'Current password',
    newPasswordPlaceholder: 'New password',
    confirmPasswordPlaceholder: 'Confirm',
    updateButton: 'Update',
    updatingButton: 'Updating...',
    userManagementTitle: 'User management',
    refreshButton: 'Refresh',
    createUserButton: 'Create user',
    creatingUserButton: 'Creating...',
    resetTokenTitle: 'Reset token',
    expiresOnLabel: 'Expires on',
    loadingUsers: 'Loading users...',
    noUsers: 'No users found.',
    accountLabel: 'Account',
    statusLabel: 'Status',
    lastLoginLabel: 'Last login',
    actionsLabel: 'Actions',
    blockedLabel: 'Blocked',
    resetButton: 'Reset',
    createUserUsernamePlaceholder: 'Username',
    createUserDisplayNamePlaceholder: 'Display name',
    createUserPasswordPlaceholder: 'Password',
    createUserConfirmPlaceholder: 'Confirm',
    roleUserLabel: 'User',
    roleAdminLabel: 'Admin',
    passwordRequiredError: 'Please enter your current and new password.',
    passwordMismatchError: 'Passwords do not match.',
    passwordUpdatedSuccess: 'Password updated.',
    passwordChangeError: 'Unable to change password.',
    userLoadError: 'Unable to load users.',
    userCreateRequiredError: 'Username and password required.',
    userCreateMismatchError: 'Passwords do not match.',
    userCreateSuccess: 'User created.',
    userCreateError: 'Unable to create user.',
    userRoleUpdateError: 'Unable to update role.',
    userStatusUpdateError: 'Unable to update status.',
    resetTokenError: 'Unable to create reset token.',
    monthUnavailableError: 'Month unavailable. Create or choose an existing month.',
    sessionExpiredError: 'Session expired. Please sign in again.',
    authRequiredError: 'Username and password required.',
    authInvalidError: 'Invalid credentials.',
    authServerError: 'Unable to connect to server.',
    expenseWizardTitle: 'Add expense',
    expenseNameLabel: 'Name',
    categoryLabel: 'Category',
    categoryAutoLabel: 'Auto',
    cancelLabel: 'Cancel',
    newIncomeSourceLabel: 'New source',
    newFixedExpenseLabel: 'New expense',
    newCategoryLabel: 'New category',
    newDepositDescription: 'New deposit',
    newExpenseDescription: 'New expense'
  }
} as const;

export type TranslationKey = keyof typeof TRANSLATIONS.fr;

export const MONTH_LABELS: Record<LanguageCode, string[]> = {
  fr: [
    'Janvier', 'Fevrier', 'Mars', 'Avril', 'Mai', 'Juin',
    'Juillet', 'Aout', 'Septembre', 'Octobre', 'Novembre', 'Decembre'
  ],
  en: [
    'January', 'February', 'March', 'April', 'May', 'June',
    'July', 'August', 'September', 'October', 'November', 'December'
  ]
};

export const createTranslator = (language: LanguageCode) => {
  const fallback = TRANSLATIONS.fr;
  const dictionary = TRANSLATIONS[language] ?? fallback;
  return (key: TranslationKey) => dictionary[key] ?? fallback[key] ?? key;
};

export const TranslationContext = createContext<{ t: (key: TranslationKey) => string; language: LanguageCode }>({
  t: (key) => TRANSLATIONS.fr[key] ?? key,
  language: 'fr'
});

export const useTranslation = () => useContext(TranslationContext);
