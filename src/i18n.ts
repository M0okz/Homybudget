import { createContext, useContext } from 'react';

export type LanguageCode = 'fr' | 'en';

export const TRANSLATIONS = {
  fr: {
    appName: 'Homybudget',
    settingsLabel: 'Paramètres',
    backLabel: 'Retour',
    logoutLabel: 'Déconnexion',
    budgetLabel: 'Budget',
    dashboardLabel: 'Tableau de bord',
    reportsLabel: 'Rapport',
    addNextMonth: 'Ajouter le mois suivant',
    deleteMonth: 'Supprimer ce mois',
    deleteMonthConfirm: 'Cette action est irréversible.',
    deleteMonthPrompt: 'Tape SUPPRIMER pour confirmer.',
    deleteMonthConfirmToken: 'SUPPRIMER',
    cancelLabel: 'Annuler',
    confirmDeleteLabel: 'Confirmer la suppression',
    deleteMonthError: 'La suppression a échoué. Vérifie la connexion au serveur.',
    monthSelectLabel: 'Sélection du mois',
    tableLabel: 'Tableau',
    person1Label: 'Personne 1',
    person2Label: 'Personne 2',
    incomeLabel: 'Revenus',
    incomePlaceholder: 'Source de revenu',
    totalIncomeLabel: 'Total Revenus',
    totalExpensesLabel: 'Total des Dépenses',
    availableLabel: 'Disponible',
    fixedMoneyLabel: 'Dépenses fixes',
    freeMoneyLabel: 'Dépenses variables',
    addLabel: 'Ajouter',
    totalExpensesShortLabel: 'Dépenses totales',
    validateExpenseLabel: 'Valider la dépense',
    editLabel: 'Éditer',
    closeEditLabel: 'Fermer',
    deleteLabel: 'Supprimer',
    moveUpLabel: 'Monter la ligne',
    moveDownLabel: 'Descendre la ligne',
    addRowLabel: 'Ajouter une ligne',
    installmentLabel: 'Paiement échelonné',
    startLabel: 'Début',
    jointAccountTitle: 'Compte joint - Épargne commune',
    depositLabel: 'Versement',
    expenseLabel: 'Dépense',
    initialBalanceLabel: 'Solde initial',
    currentBalanceLabel: 'Solde actuel',
    dateLabel: 'Date',
    typeLabel: 'Type',
    descriptionLabel: 'Description',
    amountLabel: 'Montant',
    personLabel: 'Personne',
    depositOptionLabel: '+ Versement',
    expenseOptionLabel: '- Dépense',
    noOtherPaletteLabel: 'Aucune autre palette',
    accountMenuLabel: 'Menu du compte',
    loginTitle: 'Connexion',
    loginUsernameLabel: 'Identifiant',
    loginPasswordLabel: 'Mot de passe',
    loginButton: 'Se connecter',
    loginLoading: 'Connexion...',
    loginWithProviderLabel: 'Se connecter avec',
    oidcUnlinkedError: "Ce compte n'est pas lié. Connecte-toi avec ton mot de passe puis lie-le dans les paramètres.",
    oidcInactiveError: "Ce compte est désactivé.",
    oidcFailedError: "Connexion externe impossible.",
    oidcExpiredError: 'Connexion externe expirée.',
    oidcInvalidError: 'Connexion externe invalide.',
    oidcLinkSuccess: 'Compte externe lié.',
    oidcLinkConflictError: 'Ce compte externe est déjà lié.',
    oidcLinkTitle: 'Lier un compte externe',
    oidcLinkHint: 'Associe ton compte à un fournisseur externe.',
    oidcLinkButton: 'Lier avec',
    oidcLinking: 'Liaison...',
    oidcLinkError: 'Impossible de lier le compte externe.',
    onboardingTitle: 'Première installation',
    onboardingStepLabel: 'Étape',
    onboardingAdminUsernameLabel: 'Identifiant admin',
    onboardingAdminPasswordLabel: 'Mot de passe admin',
    onboardingAdminConfirmLabel: 'Confirmer',
    onboardingCreateAdmin: 'Créer admin',
    onboardingCreatingAdmin: 'Création...',
    onboardingBootstrapError: "Impossible de créer l'admin.",
    onboardingLanguageTitle: 'Choisir la langue',
    onboardingThemeTitle: 'Mode clair ou sombre',
    onboardingModeTitle: 'Mode solo ou duo',
    onboardingSoloLabel: 'Solo',
    onboardingDuoLabel: 'Duo',
    onboardingNamesTitle: 'Noms des personnes',
    onboardingPerson1Placeholder: 'Personne 1',
    onboardingPerson2Placeholder: 'Personne 2',
    onboardingNext: 'Suivant',
    onboardingBack: 'Retour',
    onboardingFinish: 'Terminer',
    profileTitle: 'Profil',
    profileMenuLabel: 'Profil utilisateur',
    userLabel: 'Utilisateur',
    roleLabel: 'Rôle',
    profileImageLabel: 'Image de profil',
    profileImageHint: "Colle l'URL d'une image (PNG/JPG).",
    profileImageUrlPlaceholder: 'https://exemple.com/avatar.png',
    profileImageSaveButton: 'Mettre à jour',
    profileImageSaving: 'Mise à jour...',
    profileImageUpdated: 'Image mise à jour.',
    profileImageError: "Impossible de mettre à jour l'image.",
    profileImageUploadButton: 'Uploader',
    profileImageUploadLoading: 'Upload...',
    profileImageUploadSuccess: 'Image envoyée.',
    profileImageUploadError: "Impossible d'envoyer l'image.",
    settingsSectionTitle: 'Paramètres',
    sortExpensesLabel: 'Tri des dépenses par coût',
    fixedFreeLabel: 'Dépenses fixes et variables',
    jointAccountSettingLabel: 'Compte joint',
    jointAccountSettingHint: 'Afficher ou masquer le compte joint',
    soloModeSettingLabel: 'Mode solo',
    soloModeSettingHint: 'Masquer la seconde personne',
    personLinkSectionTitle: 'Association des personnes',
    personLinkSectionHint: 'Choisis quel utilisateur correspond à chaque personne.',
    unassignedLabel: 'Aucun',
    activeLabel: 'Actif',
    inactiveLabel: 'Inactif',
    defaultModeLabel: 'Mode par défaut',
    currencyLabel: 'Devise',
    currencyEuroLabel: 'Euro (EUR)',
    currencyDollarLabel: 'Dollar (USD)',
    oidcSectionTitle: 'Connexion externe (OIDC)',
    oidcEnabledLabel: 'Activer OIDC',
    oidcProviderLabel: 'Nom du provider',
    oidcIssuerLabel: 'Issuer URL',
    oidcClientIdLabel: 'Client ID',
    oidcClientSecretLabel: 'Client secret',
    oidcRedirectUriLabel: 'Redirect URI',
    themeToggleLabel: 'Mode clair/sombre',
    lightLabel: 'Clair',
    darkLabel: 'Sombre',
    languageLabel: 'Langue',
    frenchLabel: 'Français',
    englishLabel: 'English',
    moreSettingsSoon: 'Autres paramètres bientôt disponibles.',
    comingSoonLabel: 'Bientôt disponible.',
    updateAvailableLabel: 'Mise à jour dispo',
    changePasswordTitle: 'Changer le mot de passe',
    currentPasswordPlaceholder: 'Mot de passe actuel',
    newPasswordPlaceholder: 'Nouveau mot de passe',
    confirmPasswordPlaceholder: 'Confirmer',
    updateButton: 'Mettre à jour',
    updatingButton: 'Mise à jour...',
    userManagementTitle: 'Gestion des utilisateurs',
    refreshButton: 'Rafraîchir',
    createUserButton: 'Créer un utilisateur',
    creatingUserButton: 'Création...',
    resetTokenTitle: 'Token de réinitialisation',
    expiresOnLabel: 'Expire le',
    loadingUsers: 'Chargement des utilisateurs...',
    noUsers: 'Aucun utilisateur trouvé.',
    accountLabel: 'Compte',
    statusLabel: 'Statut',
    lastLoginLabel: 'Dernière connexion',
    actionsLabel: 'Actions',
    blockedLabel: 'Bloqué',
    resetButton: 'Réinitialiser',
    createUserUsernamePlaceholder: 'Identifiant',
    createUserDisplayNamePlaceholder: 'Nom affiché',
    createUserPasswordPlaceholder: 'Mot de passe',
    createUserConfirmPlaceholder: 'Confirmer',
    roleUserLabel: 'Utilisateur',
    roleAdminLabel: 'Admin',
    passwordRequiredError: 'Veuillez saisir votre mot de passe actuel et le nouveau.',
    passwordMismatchError: 'Les mots de passe ne correspondent pas.',
    passwordUpdatedSuccess: 'Mot de passe mis à jour.',
    passwordChangeError: 'Impossible de changer le mot de passe.',
    userLoadError: 'Impossible de charger les utilisateurs.',
    userCreateRequiredError: 'Identifiant et mot de passe requis.',
    userCreateMismatchError: 'Les mots de passe ne correspondent pas.',
    userCreateSuccess: 'Utilisateur créé.',
    userCreateError: "Impossible de creer l'utilisateur.",
    userRoleUpdateError: 'Impossible de mettre à jour le rôle.',
    userStatusUpdateError: 'Impossible de mettre a jour le statut.',
    resetTokenError: 'Impossible de créer le token de reset.',
    monthUnavailableError: 'Mois indisponible. Crée le mois ou choisis un mois existant.',
    sessionExpiredError: 'Session expirée. Merci de vous reconnecter.',
    authRequiredError: 'Identifiants requis.',
    authInvalidError: 'Identifiants invalides.',
    authServerError: 'Impossible de se connecter au serveur.',
    expenseWizardTitle: 'Ajouter une dépense',
    expenseWizardEditTitle: 'Modifier cette dépense',
    expenseNameLabel: 'Nom',
    categoryLabel: 'Catégorie',
    categoryAutoLabel: 'Auto',
    newIncomeSourceLabel: 'Nouvelle source',
    newFixedExpenseLabel: 'Nouvelle dépense',
    newCategoryLabel: 'Nouvelle catégorie',
    newDepositDescription: 'Nouveau versement',
    newExpenseDescription: 'Nouvelle dépense'
  },
  en: {
    appName: 'Homybudget',
    settingsLabel: 'Settings',
    backLabel: 'Back',
    logoutLabel: 'Logout',
    budgetLabel: 'Budget',
    dashboardLabel: 'Dashboard',
    reportsLabel: 'Reports',
    addNextMonth: 'Add next month',
    deleteMonth: 'Delete this month',
    deleteMonthConfirm: 'This action is irreversible.',
    deleteMonthPrompt: 'Type DELETE to confirm.',
    deleteMonthConfirmToken: 'DELETE',
    cancelLabel: 'Cancel',
    confirmDeleteLabel: 'Confirm delete',
    deleteMonthError: 'Delete failed. Check the server connection.',
    monthSelectLabel: 'Select month',
    tableLabel: 'Table',
    person1Label: 'Person 1',
    person2Label: 'Person 2',
    incomeLabel: 'Income',
    incomePlaceholder: 'Income source',
    totalIncomeLabel: 'Total Income',
    totalExpensesLabel: 'Total Expenses',
    availableLabel: 'Available',
    fixedMoneyLabel: 'Fixed expenses',
    freeMoneyLabel: 'Variable expenses',
    addLabel: 'Add',
    totalExpensesShortLabel: 'Total expenses',
    validateExpenseLabel: 'Mark expense',
    editLabel: 'Edit',
    closeEditLabel: 'Close',
    deleteLabel: 'Delete',
    moveUpLabel: 'Move up',
    moveDownLabel: 'Move down',
    addRowLabel: 'Add row',
    installmentLabel: 'Installment',
    startLabel: 'Start',
    jointAccountTitle: 'Joint Account - Shared Savings',
    depositLabel: 'Deposit',
    expenseLabel: 'Expense',
    initialBalanceLabel: 'Starting balance',
    currentBalanceLabel: 'Current balance',
    dateLabel: 'Date',
    typeLabel: 'Type',
    descriptionLabel: 'Description',
    amountLabel: 'Amount',
    personLabel: 'Person',
    depositOptionLabel: '+ Deposit',
    expenseOptionLabel: '- Expense',
    noOtherPaletteLabel: 'No other palette',
    accountMenuLabel: 'Account menu',
    loginTitle: 'Sign in',
    loginUsernameLabel: 'Username',
    loginPasswordLabel: 'Password',
    loginButton: 'Sign in',
    loginLoading: 'Signing in...',
    loginWithProviderLabel: 'Sign in with',
    oidcUnlinkedError: 'This account is not linked. Sign in with password and link it in settings.',
    oidcInactiveError: 'This account is disabled.',
    oidcFailedError: 'External login failed.',
    oidcExpiredError: 'External login expired.',
    oidcInvalidError: 'External login is invalid.',
    oidcLinkSuccess: 'External account linked.',
    oidcLinkConflictError: 'This external account is already linked.',
    oidcLinkTitle: 'Link external login',
    oidcLinkHint: 'Associate your account with an external provider.',
    oidcLinkButton: 'Link with',
    oidcLinking: 'Linking...',
    oidcLinkError: 'Unable to link external account.',
    onboardingTitle: 'First setup',
    onboardingStepLabel: 'Step',
    onboardingAdminUsernameLabel: 'Admin username',
    onboardingAdminPasswordLabel: 'Admin password',
    onboardingAdminConfirmLabel: 'Confirm',
    onboardingCreateAdmin: 'Create admin',
    onboardingCreatingAdmin: 'Creating...',
    onboardingBootstrapError: 'Unable to create admin.',
    onboardingLanguageTitle: 'Choose language',
    onboardingThemeTitle: 'Light or dark',
    onboardingModeTitle: 'Solo or duo',
    onboardingSoloLabel: 'Solo',
    onboardingDuoLabel: 'Duo',
    onboardingNamesTitle: 'People names',
    onboardingPerson1Placeholder: 'Person 1',
    onboardingPerson2Placeholder: 'Person 2',
    onboardingNext: 'Next',
    onboardingBack: 'Back',
    onboardingFinish: 'Finish',
    profileTitle: 'Profile',
    profileMenuLabel: 'User profile',
    userLabel: 'User',
    roleLabel: 'Role',
    profileImageLabel: 'Profile image',
    profileImageHint: 'Paste an image URL (PNG/JPG).',
    profileImageUrlPlaceholder: 'https://example.com/avatar.png',
    profileImageSaveButton: 'Update',
    profileImageSaving: 'Updating...',
    profileImageUpdated: 'Image updated.',
    profileImageError: 'Unable to update image.',
    profileImageUploadButton: 'Upload',
    profileImageUploadLoading: 'Uploading...',
    profileImageUploadSuccess: 'Image uploaded.',
    profileImageUploadError: 'Unable to upload image.',
    settingsSectionTitle: 'Preferences',
    sortExpensesLabel: 'Sort expenses by cost',
    fixedFreeLabel: 'Fixed and variable expenses',
    jointAccountSettingLabel: 'Joint account',
    jointAccountSettingHint: 'Show or hide the joint account',
    soloModeSettingLabel: 'Solo mode',
    soloModeSettingHint: 'Hide the second person',
    personLinkSectionTitle: 'People mapping',
    personLinkSectionHint: 'Choose which user is Person 1 and Person 2.',
    unassignedLabel: 'None',
    activeLabel: 'Active',
    inactiveLabel: 'Inactive',
    defaultModeLabel: 'Default theme',
    currencyLabel: 'Currency',
    currencyEuroLabel: 'Euro (EUR)',
    currencyDollarLabel: 'Dollar (USD)',
    oidcSectionTitle: 'External login (OIDC)',
    oidcEnabledLabel: 'Enable OIDC',
    oidcProviderLabel: 'Provider name',
    oidcIssuerLabel: 'Issuer URL',
    oidcClientIdLabel: 'Client ID',
    oidcClientSecretLabel: 'Client secret',
    oidcRedirectUriLabel: 'Redirect URI',
    themeToggleLabel: 'Light/Dark mode',
    lightLabel: 'Light',
    darkLabel: 'Dark',
    languageLabel: 'Language',
    frenchLabel: 'French',
    englishLabel: 'English',
    moreSettingsSoon: 'More settings coming soon.',
    comingSoonLabel: 'Coming soon.',
    updateAvailableLabel: 'update available',
    changePasswordTitle: 'Change password',
    currentPasswordPlaceholder: 'Current password',
    newPasswordPlaceholder: 'New password',
    confirmPasswordPlaceholder: 'Confirm',
    updateButton: 'Update',
    updatingButton: 'Updating...',
    userManagementTitle: 'User management',
    refreshButton: 'Refresh',
    createUserButton: 'Create user',
    creatingUserButton: 'Creating...',
    resetTokenTitle: 'Reset token',
    expiresOnLabel: 'Expires on',
    loadingUsers: 'Loading users...',
    noUsers: 'No users found.',
    accountLabel: 'Account',
    statusLabel: 'Status',
    lastLoginLabel: 'Last login',
    actionsLabel: 'Actions',
    blockedLabel: 'Blocked',
    resetButton: 'Reset',
    createUserUsernamePlaceholder: 'Username',
    createUserDisplayNamePlaceholder: 'Display name',
    createUserPasswordPlaceholder: 'Password',
    createUserConfirmPlaceholder: 'Confirm',
    roleUserLabel: 'User',
    roleAdminLabel: 'Admin',
    passwordRequiredError: 'Please enter your current and new password.',
    passwordMismatchError: 'Passwords do not match.',
    passwordUpdatedSuccess: 'Password updated.',
    passwordChangeError: 'Unable to change password.',
    userLoadError: 'Unable to load users.',
    userCreateRequiredError: 'Username and password required.',
    userCreateMismatchError: 'Passwords do not match.',
    userCreateSuccess: 'User created.',
    userCreateError: 'Unable to create user.',
    userRoleUpdateError: 'Unable to update role.',
    userStatusUpdateError: 'Unable to update status.',
    resetTokenError: 'Unable to create reset token.',
    monthUnavailableError: 'Month unavailable. Create or choose an existing month.',
    sessionExpiredError: 'Session expired. Please sign in again.',
    authRequiredError: 'Username and password required.',
    authInvalidError: 'Invalid credentials.',
    authServerError: 'Unable to connect to server.',
    expenseWizardTitle: 'Add expense',
    expenseWizardEditTitle: 'Edit expense',
    expenseNameLabel: 'Name',
    categoryLabel: 'Category',
    categoryAutoLabel: 'Auto',
    newIncomeSourceLabel: 'New source',
    newFixedExpenseLabel: 'New expense',
    newCategoryLabel: 'New category',
    newDepositDescription: 'New deposit',
    newExpenseDescription: 'New expense'
  }
} as const;

export type TranslationKey = keyof typeof TRANSLATIONS.fr;

export const MONTH_LABELS: Record<LanguageCode, string[]> = {
  fr: [
    'Janvier', 'Fevrier', 'Mars', 'Avril', 'Mai', 'Juin',
    'Juillet', 'Aout', 'Septembre', 'Octobre', 'Novembre', 'Decembre'
  ],
  en: [
    'January', 'February', 'March', 'April', 'May', 'June',
    'July', 'August', 'September', 'October', 'November', 'December'
  ]
};

export const createTranslator = (language: LanguageCode) => {
  const fallback = TRANSLATIONS.fr;
  const dictionary = TRANSLATIONS[language] ?? fallback;
  return (key: TranslationKey) => dictionary[key] ?? fallback[key] ?? key;
};

export const TranslationContext = createContext<{ t: (key: TranslationKey) => string; language: LanguageCode }>({
  t: (key) => TRANSLATIONS.fr[key] ?? key,
  language: 'fr'
});

export const useTranslation = () => useContext(TranslationContext);
